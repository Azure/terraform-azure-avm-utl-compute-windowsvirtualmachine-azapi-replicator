Test Case: disk_os_storage_account_type_premium_zrs
================================================================================

Initial Error:
Error: Unsupported attribute
  on azapi.tf line 44, in resource "azapi_resource" "this":
  44:     for_each = can(module.replicator.azapi_header.identity) ? [module.replicator.identity] : []
     ├────────────────
     │ module.replicator is object with 8 attributes

This object does not have an attribute named "identity".

Fix Process:

Attempt 1:
- Problem Analysis: Line 44 checks if azapi_header.identity exists, but then references module.replicator.identity which doesn't exist as a separate output. The identity is part of azapi_header.identity.
- Fix Method: Change module.replicator.identity to module.replicator.azapi_header.identity on line 44
- Changes Made: Updated azapi.tf line 44 from [module.replicator.identity] to [module.replicator.azapi_header.identity]
- Result: Still failed - identity.value is null

Attempt 2:
- Problem Analysis: The identity exists in azapi_header but is null. The can() function returns true even for null values, so for_each iterates over [null] which causes the error.
- Fix Method: Change the condition to explicitly check for null: try(module.replicator.azapi_header.identity, null) != null
- Changes Made: Updated azapi.tf line 44 condition from can() to try() with null check
- Result: Success - plan now works and shows acceptable drifts only

Final Result: Fix successful

Drift Analysis:
All detected drifts are acceptable according to acceptable_drift_patterns.md:
1. Resource-level attributes (ignore_null_property, locks, replace_triggers_external_values, sensitive_body_version, output, type) - All acceptable
2. Body changes are all Optional+Computed fields being removed due to ignore_null_property=true - All acceptable
