Test Case: orchestrated_multiple_non_zonal
================================================================================

Initial Error:
Error: Unsupported attribute
  on azapi.tf line 47, in resource "azapi_resource" "this":
  47:     for_each = can(module.replicator.azapi_header.identity) ? [module.replicator.identity] : []
     ├────────────────
     │ module.replicator is object with 8 attributes
This object does not have an attribute named "identity".

Fix Process:

Attempt 1:
- Problem Analysis: The azapi.tf file is trying to access module.replicator.identity, but the module doesn't have an identity output. The identity is actually nested inside module.replicator.azapi_header.identity
- Fix Method: Change the for_each from [module.replicator.identity] to [module.replicator.azapi_header.identity]
- Changes Made: Line 47 of azapi.tf: Changed "module.replicator.identity" to "module.replicator.azapi_header.identity"
- Result: Testing...

Attempt 2:
- Problem Analysis: The identity is null (this VM doesn't have an identity configured), so can() returns true even for null values. Need to explicitly check for != null
- Fix Method: Change the condition from can(module.replicator.azapi_header.identity) to module.replicator.azapi_header.identity != null
- Changes Made: Line 47 of azapi.tf: Changed condition to check for != null instead of can()
- Result: Success - Plan shows acceptable drift only (AzAPI provider attributes and computed defaults)

Final Result: Fix successful - All test steps completed without errors
